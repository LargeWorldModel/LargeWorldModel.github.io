<!DOCTYPE html>
<html class="fontawesome-i2svg-active fontawesome-i2svg-complete">
<head>
    <title>ElasticTok: Adaptive Tokenization for Image and Video</title>
    <style type="text/css">svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top left;transform-origin:top left}.fa-lg{font-size:1.3333333333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:solid .08em #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.fa-rotate-90{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.fa-flip-vertical{-webkit-transform:scale(1,-1);transform:scale(1,-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1,-1);transform:scale(-1,-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor);opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fad.fa-inverse{color:#fff}</style><link rel="icon" type="image/x-icon" href="static/globe.png">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="">
    <meta name="keywords" content="Large World Models, LWM">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./static/css/index.css">
    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="./static/css/academicons.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="./static/css/index.js"></script>
  </head>
  <body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-widescreen">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">ElasticTok: Adaptive Tokenization for Image and Video</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://wilson1yan.github.io/">Wilson Yan</a><sup>* &dagger;</sup>,&nbsp;
            </span>
            <span class="author-block">
              <a href="https://people.eecs.berkeley.edu/~matei/">Matei Zaharia</a><sup>&dagger;</sup>,&nbsp;
            </span>
            <span class="author-block">
              <a href="https://www.cs.toronto.edu/~vmnih/">Volodymyr Mnih</a><sup>&loz;</sup>,&nbsp;
            </span>
            <span class="author-block">
              <a href="https://people.eecs.berkeley.edu/~pabbeel/">Pieter Abbeel</a><sup>&dagger;</sup>,&nbsp;
            </span>
            <span class="author-block">
              <a href="https://www.afaust.info/">Aleksandra Faust</a><sup>&loz;</sup>,&nbsp;
            </span>
            <span class="author-block">
              <a href="https://www.haoliu.ai/">Hao Liu</a><sup>* &loz;</sup>&nbsp;
            </span>
            <ul>
            <sup>&dagger;</sup> UC Berkeley, <sup>&loz;</sup> Google DeepMind
            </ul>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/abs/2410.08368" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/LargeWorldModel/ElasticTok" class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            <span class="link-block">
              <a href="https://huggingface.co/LargeWorldModel" target="_blank" class="external-link button is-normal is-rounded is-dark">
              <span class="icon">
                <img src="./static/hf-logo.svg" alt="My Icon">
              </span>
              <span>Model</span>
            </a>
            </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
<!-- Paper abstract -->
<div class="container is-max-desktop">
  <div class="columns is-centered has-text-centered">
    <div class="column is-four-fifths">
      <h2 class="title is-3">Abstract</h2>
      <div class="content has-text-justified">
        <p>
          Efficient video tokenization remains a key bottleneck in learning general purpose
          vision models that are capable of processing long video sequences. Prevailing
          approaches are restricted to encoding videos to a fixed number of tokens, where too
          few tokens will result in overly lossy encodings, and too many tokens will result
          in prohibitively long sequence lengths. In this work, we introduce ElasticTok, a
          method that conditions on prior frames to adaptively encode a frame into a variable
          number of tokens. To enable this in a computationally scalable way, we propose
          a masking technique that drops a random number of tokens at the end of each
          frames’s token encoding. During inference, ElasticTok can dynamically allocate
          tokens when needed – more complex data can leverage more tokens, while simpler
          data only needs a few tokens. Our empirical evaluations on images and video
          demonstrate the effectiveness of our approach in efficient token usage, paving the
          way for future development of more powerful multimodal models, world models,
          and agents.
          <br><br><br><br>
        </p>
      </div>
    </div>
  </div>
<!-- End paper abstract -->
<!-- Model figure -->
<div class="columns is-centered has-text-centered">
  <div class="column is-four-fifths">
    <h2 class="title is-3" style="white-space: nowrap;">Adaptive Tokenizing in a Block Causal Structure</h2>
    <div class="content has-text-justified">
      <div style="text-align: center;">
      <img src="./materials/method.png" alt="Model" width="700">
      <p class="caption" style="width: 100%; text-align: center;"><b>Figure 2. ElasticTok adaptively encodes image and video to variable length outputs based on the complexity of the input data.</b> Single block uses an Encoder-Decoder pipeline with a sampled latent mask. Multi-block extends this with a Block Causal Mask to handle longer video sequences. </p>
      </div>
    </div>
    <br><br>
  </div>
</div>
<!-- End model figure -->

<!-- Quant Figure  -->
<div class="columns is-centered has-text-centered">
  <div class="column is-four-fifths">
    <h2 class="title is-3" style="white-space: nowrap;">Adaptive Tokenization with ElasticTok</h2>
    <div class="content has-text-justified">
      <div style="text-align: center;">
      <img src="./materials/main_quantitative.png" alt="Data Mixture" width="900">
      <p class="caption" style="width: 100%; text-align: center;"><b>Figure 4. Performance comparison between baseline and ElasticTok on ImageNet and Video.</b> The y-axis shows the percentage of samples that satisfy the reconstruction threshold, while the x-axis represents the percentage of tokens used. (Left) On image, ElasticTok achieves a 3.5x and 1.3x efficiency boost at different target reconstruction thresholds. (Right) On video, ElasticTok shows a 5x and 2.4x improvement over the baseline, maintaining superior performance while using fewer tokens.</p>
    </div>
    </div>
    <br><br>
  </div>
</div>
<!-- End Quant figure -->

<div class="section">
      <h2 class="title is-3" style="white-space: nowrap; text-align: center">Adaptive Encoding Examples</h2>
      <hr>
      <p>
      Below, we show examples of the adaptive tokenization capabilities of ElasticTok. For each video, ground truth is the left image and reconstruction the right image.
      The bottom image shows the percentage of tokens used over each frame as the video plays. Typically, simpler scenes, or scenes with less motion will use fewer frames,
      while larger transitions such as fast motion or scene cuts will result in brief token usage spikes as our model adaptively encodes.
      </p>

    <div class="section">
      <h3 class="title is-3" style="white-space: nowrap; text-align: center">Short Video</h3>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/short/000000000_t01.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/short/000000001_t01.mp4" type="video/mp4">
            </video>
        </div>
      </div>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/short/000000002_t02.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/short/000000003_t02.mp4" type="video/mp4">
            </video>
        </div>
      </div>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/short/000000004_t01.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/short/000000005_t02.mp4" type="video/mp4">
            </video>
        </div>
      </div>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/short/000000008_t01.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/short/000000009_t02.mp4" type="video/mp4">
            </video>
        </div>
      </div>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/short/000000010_t02.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/short/000000012_t02.mp4" type="video/mp4">
            </video>
        </div>
      </div>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/short/000000013_t02.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/short/000000015_t01.mp4" type="video/mp4">
            </video>
        </div>
      </div>

      <br><br>

      <h3 class="title is-3" style="white-space: nowrap; text-align: center">Long Video</h3>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/long/v1.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/long/v2.mp4" type="video/mp4">
            </video>
        </div>
      </div>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/long/v7.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/long/v10.mp4" type="video/mp4">
            </video>
        </div>
      </div>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/long/v12.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/long/v13.mp4" type="video/mp4">
            </video>
        </div>
      </div>
      <br><br>
      <h3 class="title is-3" style="white-space: nowrap; text-align: center">Varying Reconstruction Threshold</h3>
      <p> The following videos show different MSE reconstruction thresholds for the same video. The left video uses a more strict threshold of 0.001,
      which always requires all tokens due to the complexity of the video. The right video uses a higher threshold of 0.007 which is able to benefit
      more from the adaptivity of ElasticTok.</p>
      <div style="width: 100%; overflow: hidden;">
        <div style="width: 49%; float: left;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
              <source src="./videos/thresholds/000000014_t01.mp4" type="video/mp4">
              </video>
        </div>
        <div style="width: 2%;"> </div>
        <div style="width: 49%; float: right;">
            <video width="100%" onloadstart="this.playbackRate = 0.75" loop playsinline muted controls="">
            <source src="./videos/thresholds/000000014_t04.mp4" type="video/mp4">
            </video>
        </div>
      </div>


</div>

</section>

</body></html>
